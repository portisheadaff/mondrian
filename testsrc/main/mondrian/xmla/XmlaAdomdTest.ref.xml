<?xml version="1.0" ?>
<Root>
    <TestCase name="testDuplicateHierarchyInSlicer">
        <Resource name="response">
            <![CDATA[<?xml version="1.0"?>
<SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    <SOAP-ENV:Header/>
    <SOAP-ENV:Body>
        <ExecuteResponse xmlns="urn:schemas-microsoft-com:xml-analysis">
            <return>
                <root xmlns="urn:schemas-microsoft-com:xml-analysis:mddataset" xmlns:EX="urn:schemas-microsoft-com:xml-analysis:exception" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                    <xsd:schema elementFormDefault="qualified" targetNamespace="urn:schemas-microsoft-com:xml-analysis:mddataset" xmlns="urn:schemas-microsoft-com:xml-analysis:mddataset" xmlns:sql="urn:schemas-microsoft-com:xml-sql" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                        <xsd:complexType name="MemberType">
                            <xsd:sequence>
                                <xsd:element name="UName" type="xsd:string"/>
                                <xsd:element name="Caption" type="xsd:string"/>
                                <xsd:element name="LName" type="xsd:string"/>
                                <xsd:element name="LNum" type="xsd:unsignedInt"/>
                                <xsd:element name="DisplayInfo" type="xsd:unsignedInt"/>
                                <xsd:sequence maxOccurs="unbounded" minOccurs="0">
                                    <xsd:any maxOccurs="unbounded" processContents="lax"/>
                                </xsd:sequence>
                            </xsd:sequence>
                            <xsd:attribute name="Hierarchy" type="xsd:string"/>
                        </xsd:complexType>
                        <xsd:complexType name="PropType">
                            <xsd:attribute name="name" type="xsd:string"/>
                        </xsd:complexType>
                        <xsd:complexType name="TupleType">
                            <xsd:sequence maxOccurs="unbounded">
                                <xsd:element name="Member" type="MemberType"/>
                            </xsd:sequence>
                        </xsd:complexType>
                        <xsd:complexType name="MembersType">
                            <xsd:sequence maxOccurs="unbounded">
                                <xsd:element name="Member" type="MemberType"/>
                            </xsd:sequence>
                            <xsd:attribute name="Hierarchy" type="xsd:string"/>
                        </xsd:complexType>
                        <xsd:complexType name="TuplesType">
                            <xsd:sequence maxOccurs="unbounded">
                                <xsd:element name="Tuple" type="TupleType"/>
                            </xsd:sequence>
                        </xsd:complexType>
                        <xsd:complexType name="CrossProductType">
                            <xsd:sequence>
                                <xsd:choice maxOccurs="unbounded" minOccurs="0">
                                    <xsd:element name="Members" type="MembersType"/>
                                    <xsd:element name="Tuples" type="TuplesType"/>
                                </xsd:choice>
                            </xsd:sequence>
                            <xsd:attribute name="Size" type="xsd:unsignedInt"/>
                        </xsd:complexType>
                        <xsd:complexType name="OlapInfo">
                            <xsd:sequence>
                                <xsd:element name="CubeInfo">
                                    <xsd:complexType>
                                        <xsd:sequence>
                                            <xsd:element maxOccurs="unbounded" name="Cube">
                                                <xsd:complexType>
                                                    <xsd:sequence>
                                                        <xsd:element name="CubeName" type="xsd:string"/>
                                                    </xsd:sequence>
                                                </xsd:complexType>
                                            </xsd:element>
                                        </xsd:sequence>
                                    </xsd:complexType>
                                </xsd:element>
                                <xsd:element name="AxesInfo">
                                    <xsd:complexType>
                                        <xsd:sequence>
                                            <xsd:element maxOccurs="unbounded" name="AxisInfo">
                                                <xsd:complexType>
                                                    <xsd:sequence>
                                                        <xsd:element maxOccurs="unbounded" minOccurs="0" name="HierarchyInfo">
                                                            <xsd:complexType>
                                                                <xsd:sequence>
                                                                    <xsd:sequence maxOccurs="unbounded">
                                                                        <xsd:element name="UName" type="PropType"/>
                                                                        <xsd:element name="Caption" type="PropType"/>
                                                                        <xsd:element name="LName" type="PropType"/>
                                                                        <xsd:element name="LNum" type="PropType"/>
                                                                        <xsd:element maxOccurs="unbounded" minOccurs="0" name="DisplayInfo" type="PropType"/>
                                                                    </xsd:sequence>
                                                                    <xsd:sequence>
                                                                        <xsd:any maxOccurs="unbounded" minOccurs="0" processContents="lax"/>
                                                                    </xsd:sequence>
                                                                </xsd:sequence>
                                                                <xsd:attribute name="name" type="xsd:string" use="required"/>
                                                            </xsd:complexType>
                                                        </xsd:element>
                                                    </xsd:sequence>
                                                    <xsd:attribute name="name" type="xsd:string"/>
                                                </xsd:complexType>
                                            </xsd:element>
                                        </xsd:sequence>
                                    </xsd:complexType>
                                </xsd:element>
                                <xsd:element name="CellInfo">
                                    <xsd:complexType>
                                        <xsd:sequence>
                                            <xsd:sequence maxOccurs="unbounded" minOccurs="0">
                                                <xsd:choice>
                                                    <xsd:element name="Value" type="PropType"/>
                                                    <xsd:element name="FmtValue" type="PropType"/>
                                                    <xsd:element name="BackColor" type="PropType"/>
                                                    <xsd:element name="ForeColor" type="PropType"/>
                                                    <xsd:element name="FontName" type="PropType"/>
                                                    <xsd:element name="FontSize" type="PropType"/>
                                                    <xsd:element name="FontFlags" type="PropType"/>
                                                    <xsd:element name="FormatString" type="PropType"/>
                                                    <xsd:element name="NonEmptyBehavior" type="PropType"/>
                                                    <xsd:element name="SolveOrder" type="PropType"/>
                                                    <xsd:element name="Updateable" type="PropType"/>
                                                    <xsd:element name="Visible" type="PropType"/>
                                                    <xsd:element name="Expression" type="PropType"/>
                                                </xsd:choice>
                                            </xsd:sequence>
                                            <xsd:sequence maxOccurs="unbounded" minOccurs="0">
                                                <xsd:any maxOccurs="unbounded" processContents="lax"/>
                                            </xsd:sequence>
                                        </xsd:sequence>
                                    </xsd:complexType>
                                </xsd:element>
                            </xsd:sequence>
                        </xsd:complexType>
                        <xsd:complexType name="Axes">
                            <xsd:sequence maxOccurs="unbounded">
                                <xsd:element name="Axis">
                                    <xsd:complexType>
                                        <xsd:choice maxOccurs="unbounded" minOccurs="0">
                                            <xsd:element name="CrossProduct" type="CrossProductType"/>
                                            <xsd:element name="Tuples" type="TuplesType"/>
                                            <xsd:element name="Members" type="MembersType"/>
                                        </xsd:choice>
                                        <xsd:attribute name="name" type="xsd:string"/>
                                    </xsd:complexType>
                                </xsd:element>
                            </xsd:sequence>
                        </xsd:complexType>
                        <xsd:complexType name="CellData">
                            <xsd:sequence>
                                <xsd:element maxOccurs="unbounded" minOccurs="0" name="Cell">
                                    <xsd:complexType>
                                        <xsd:sequence maxOccurs="unbounded">
                                            <xsd:choice>
                                                <xsd:element name="Value"/>
                                                <xsd:element name="FmtValue" type="xsd:string"/>
                                                <xsd:element name="BackColor" type="xsd:unsignedInt"/>
                                                <xsd:element name="ForeColor" type="xsd:unsignedInt"/>
                                                <xsd:element name="FontName" type="xsd:string"/>
                                                <xsd:element name="FontSize" type="xsd:unsignedShort"/>
                                                <xsd:element name="FontFlags" type="xsd:unsignedInt"/>
                                                <xsd:element name="FormatString" type="xsd:string"/>
                                                <xsd:element name="NonEmptyBehavior" type="xsd:unsignedShort"/>
                                                <xsd:element name="SolveOrder" type="xsd:unsignedInt"/>
                                                <xsd:element name="Updateable" type="xsd:unsignedInt"/>
                                                <xsd:element name="Visible" type="xsd:unsignedInt"/>
                                                <xsd:element name="Expression" type="xsd:string"/>
                                            </xsd:choice>
                                        </xsd:sequence>
                                        <xsd:attribute name="CellOrdinal" type="xsd:unsignedInt" use="required"/>
                                    </xsd:complexType>
                                </xsd:element>
                            </xsd:sequence>
                        </xsd:complexType>
                        <xsd:element name="root">
                            <xsd:complexType>
                                <xsd:sequence maxOccurs="unbounded">
                                    <xsd:element name="OlapInfo" type="OlapInfo"/>
                                    <xsd:element name="Axes" type="Axes"/>
                                    <xsd:element name="CellData" type="CellData"/>
                                </xsd:sequence>
                            </xsd:complexType>
                        </xsd:element>
                    </xsd:schema>
                    <OlapInfo>
                        <CubeInfo>
                            <Cube>
                                <CubeName>StoreDup</CubeName>
                            </Cube>
                        </CubeInfo>
                        <AxesInfo>
                            <AxisInfo name="Axis0">
                                <HierarchyInfo name="[Measures]">
                                    <UName name="[Measures].[MEMBER_UNIQUE_NAME]"/>
                                    <Caption name="[Measures].[MEMBER_CAPTION]"/>
                                    <LName name="[Measures].[LEVEL_UNIQUE_NAME]"/>
                                    <LNum name="[Measures].[LEVEL_NUMBER]"/>
                                    <DisplayInfo name="[Measures].[DISPLAY_INFO]"/>
                                </HierarchyInfo>
                            </AxisInfo>
                            <AxisInfo name="Axis1">
                                <HierarchyInfo name="[Warehouse]">
                                    <UName name="[Warehouse].[MEMBER_UNIQUE_NAME]"/>
                                    <Caption name="[Warehouse].[MEMBER_CAPTION]"/>
                                    <LName name="[Warehouse].[LEVEL_UNIQUE_NAME]"/>
                                    <LNum name="[Warehouse].[LEVEL_NUMBER]"/>
                                    <DisplayInfo name="[Warehouse].[DISPLAY_INFO]"/>
                                </HierarchyInfo>
                            </AxisInfo>
                            <AxisInfo name="SlicerAxis">
                                <HierarchyInfo name="[A Store].[SharedStore]">
                                    <UName name="[A Store].[SharedStore].[MEMBER_UNIQUE_NAME]"/>
                                    <Caption name="[A Store].[SharedStore].[MEMBER_CAPTION]"/>
                                    <LName name="[A Store].[SharedStore].[LEVEL_UNIQUE_NAME]"/>
                                    <LNum name="[A Store].[SharedStore].[LEVEL_NUMBER]"/>
                                    <DisplayInfo name="[A Store].[SharedStore].[DISPLAY_INFO]"/>
                                </HierarchyInfo>
                                <HierarchyInfo name="[AnotherStore].[SharedStore]">
                                    <UName name="[AnotherStore].[SharedStore].[MEMBER_UNIQUE_NAME]"/>
                                    <Caption name="[AnotherStore].[SharedStore].[MEMBER_CAPTION]"/>
                                    <LName name="[AnotherStore].[SharedStore].[LEVEL_UNIQUE_NAME]"/>
                                    <LNum name="[AnotherStore].[SharedStore].[LEVEL_NUMBER]"/>
                                    <DisplayInfo name="[AnotherStore].[SharedStore].[DISPLAY_INFO]"/>
                                </HierarchyInfo>
                            </AxisInfo>
                        </AxesInfo>
                        <CellInfo>
                            <Value name="VALUE"/>
                            <FmtValue name="FORMATTED_VALUE"/>
                            <FormatString name="FORMAT_STRING"/>
                        </CellInfo>
                    </OlapInfo>
                    <Axes>
                        <Axis name="Axis0">
                            <Tuples>
                                <Tuple>
                                    <Member Hierarchy="[Measures]">
                                        <UName>[Measures].[Store Invoice]</UName>
                                        <Caption>Store Invoice</Caption>
                                        <LName>[Measures].[MeasuresLevel]</LName>
                                        <LNum>0</LNum>
                                        <DisplayInfo>0</DisplayInfo>
                                    </Member>
                                </Tuple>
                            </Tuples>
                        </Axis>
                        <Axis name="Axis1">
                            <Tuples>
                                <Tuple>
                                    <Member Hierarchy="[Warehouse]">
                                        <UName>[Warehouse].[All Warehouses]</UName>
                                        <Caption>All Warehouses</Caption>
                                        <LName>[Warehouse].[(All)]</LName>
                                        <LNum>0</LNum>
                                        <DisplayInfo>3</DisplayInfo>
                                    </Member>
                                </Tuple>
                            </Tuples>
                        </Axis>
                        <Axis name="SlicerAxis">
                            <Tuples>
                                <Tuple>
                                    <Member Hierarchy="[A Store].[SharedStore]">
                                        <UName>[SharedStore].[All]</UName>
                                        <Caption>All</Caption>
                                        <LName>[SharedStore].[(All)]</LName>
                                        <LNum>0</LNum>
                                        <DisplayInfo>3</DisplayInfo>
                                    </Member>
                                    <Member Hierarchy="[AnotherStore].[SharedStore]">
                                        <UName>[SharedStore].[All]</UName>
                                        <Caption>All</Caption>
                                        <LName>[SharedStore].[(All)]</LName>
                                        <LNum>0</LNum>
                                        <DisplayInfo>3</DisplayInfo>
                                    </Member>
                                </Tuple>
                            </Tuples>
                        </Axis>
                    </Axes>
                    <CellData>
                        <Cell CellOrdinal="0">
                            <Value xsi:type="xsd:double">102278.4089</Value>
                            <FmtValue>102,278.409</FmtValue>
                            <FormatString/>
                        </Cell>
                    </CellData>
                </root>
            </return>
        </ExecuteResponse>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope>
]]>
        </Resource>
        <Resource name="request">
            <![CDATA[
<soapenv:Envelope
    xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <soapenv:Body>
        <Execute xmlns="urn:schemas-microsoft-com:xml-analysis">
        <Command>
        <Statement>
select {[Warehouse].[All Warehouses]} ON ROWS,
[Measures].[Store Invoice] ON COLUMNS from [StoreDup]
         </Statement>
        </Command>
        <Restrictions>
          <RestrictionList>
            <CATALOG_NAME>${catalog}</CATALOG_NAME>
          </RestrictionList>
        </Restrictions>
        <Properties>
          <PropertyList>
            <DataSourceInfo>${data.source.info}</DataSourceInfo>
            <Format>${format}</Format>
            <AxisFormat>TupleFormat</AxisFormat>
          </PropertyList>
        </Properties>
</Execute>
</soapenv:Body>
</soapenv:Envelope>
]]>
        </Resource>
    </TestCase>
</Root>
